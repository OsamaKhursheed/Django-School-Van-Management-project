{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Owner Portal - School Van Management System</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
<style>
    body {
        background-color: #f0f0f0;
        margin: 0;
        padding: 0;
    }
    .image-frame {
        border-radius: 50%;
        overflow: hidden;
        width: 200px;
        height: 200px;
        margin: 0 auto;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .image-frame img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        margin-left: 5px;
    }

    .open-btn {
        font-size: 20px;
        cursor: pointer;
    }

    .sidebar {
        height: 100%;
        width: 250px;
        position: fixed;
        z-index: 1;
        top: 0px;
        left: -250px;
        background-color: white;
        overflow-x: hidden;
        transition: 0.5s;
        padding-top: 25px;
        border-radius: 0 0 15px 0;
        border-top: 1px solid black;
        border-bottom: 1px solid black;
        display: flex;
        flex-direction: column;
    }

    .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 0;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 0;
        opacity: 0;
        transition: 0.5s;
    }

    .sidebar-button {
        text-align: left;
        text-decoration: none;
        color: black;
        transition: 0.3s;
        background-color: white;
        position: relative;
        margin: 0;
        margin-left: 5px;
        margin-right: 5px;
        font-size: 16px;
        border: none;
        width: 95%;
        height: 40px;
        line-height: 1.5;
        padding-left: 100px;
        padding: 10px;
        border-radius: 5px;
    }

    .sidebar-button:hover {
        background-color: #3498db;
        color: #fff;
    }

    .closebtn {
        position: absolute;
        top: 0;
        right: 5px;
        font-size: 20px;
    }

    .image-text {
        display: flex;
        align-items: center;
        font-size: 15px;
        margin-left: 5px;
    }

    .image-text img {
        border-radius: 50%;
        border-color: black;
        width: 50px;
        height: 50px;
        object-fit: cover;
    }

    .sidebar-image {
        text-align: left;
        margin-top: auto;
        margin-bottom: 20px;
    }

    .sidebar-image img {
        border-radius: 50%;
        width: 50px;
        height: 50px;
        object-fit: cover;
    }

    .sidebar-button:focus {
        outline: none;
    }

    hr {
        border: none;
        background-color: black;
        height: 1px;
        margin-top: 20px;
        margin-bottom: 20px;
        margin-left: 10px;
        margin-right: 10px;
    }

    .image-button {
        display: flex;
        align-items: center;
        background: none;
        border: none;
        cursor: pointer;
    }

    .image-button img {
        border-radius: 50%;
        width: 50px;
        height: 50px;
        object-fit: cover;
        margin-right: 10px;
        margin-left: 10px;
    }

    .title {
        margin: 0;
    }

    #RequestsDropdown {
        display: none;
    }

    #RequestsDropdown a {
        padding: 1px 3px;
        text-decoration: none;
        display: block;
        color: #333;
    }

    #RequestsDropdown a:hover {
        background-color: #f1f1f1;
    }

    #registrationDropdown {
        display: none;
    }

    #registrationDropdown a {
        padding: 1px 3px;
        text-decoration: none;
        display: block;
        color: #333;
    }

    #registrationDropdown a:hover {
        background-color: #f1f1f1;
    }

    .rotate-down {
        transform: rotate(90deg);
        transition: transform 0.3s ease;
    }

    .rotate-down.active {
        transform: rotate(180deg);
    }

    @media (max-width: 768px) {
        .image-frame {
            width: 150px;
            height: 150px;
        }
    }    
    .container-fluid {
        padding: 0;
        margin: 0;
    }
</style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">School Van Management System</a>
            <button class="navbar-toggler" type="button" id="toggleNav" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <!-- Add the "Open" button to toggle the navigation bar -->
                    <li class="nav-item">
                        <a class="nav-link open-btn" href="javascript:void(0);" onclick="openNav()"><i class="bi bi-text-left" ></i> Open</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container mt-4">
        <div class="row">
            <div class="col-md-12 text-center">
                <div class="image-frame">
                    <img src="{% static 'images/owner_portal.jpg' %}" class="img-fluid" alt="Osama Khursheed">
                </div>
                <h2 class="title">Osama Khursheed</h2>
                <div class="card mt-4">
                    <div class="card-body">
                        <h4 class="card-title">Your Fee Revenue</h4>
                        <p class="card-text">${{ total_owner_fee }}</p>
                    </div>
                </div>
                <div class="container my-4">
                    <div class="user-section bg-light p-4">
                        <h2 class="text-left">Approve or Reject Student Request</h2>
                        <p class="text-left">You can efficiently manage student registration by reviewing and either approving or rejecting student registration requests. This ensures that only eligible students are admitted to your van. You can also assign a driver to a student automatically according to his area by approving the request.</p>
                    </div>
                </div>
                
                <div class="container my-4">
                    <div class="user-section bg-light p-4">
                        <h2 class="text-left">Approve or Reject Driver Request</h2>
                        <p class="text-left">You can efficiently manage driver registration by reviewing and either approving or rejecting driver registration requests. This ensures that only eligible drivers are admitted to your system.</p>
                    </div>
                </div>
                
                <div class="container my-4">
                    <div class="user-section bg-light p-4">
                        <h2 class="text-left">Approve or Reject Fee Increase Request</h2>
                        <p class="text-left">Van owners can evaluate requests for fee increases from your drivers and decide whether to approve or reject them. This ensures that fee adjustments are made fairly and transparently.</p>
                    </div>
                </div>
                
                <div class="container my-4">
                    <div class="user-section bg-light p-4">
                        <h2 class="text-left">Approve or Reject Delay Request</h2>
                        <p class="text-left">Drivers may request delays due to valid reasons like illness or vehicle issues. You can review and grant or deny these delay requests, ensuring smooth operations.</p>
                    </div>
                </div>
                
                <div class="container my-4">
                    <div class="user-section bg-light p-4">
                        <h2 class="text-left">View Fee Record</h2>
                        <p class="text-left">You can view fee records for individual students or across the van students. This feature provides transparency in financial transactions and helps in monitoring fee payment status. And by this portal, you can also send emails to parents about unpaid fees and generate fee voucher PDF attachments.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Overlay to fade the content -->
    <div class="overlay" id="overlay" onclick="closeNav()"></div>

    <!-- Sidebar -->
    <div id="mySidebar" class="sidebar">
        <div class="sidebar-button"><strong><i class="bi bi-car-front"></i> SVMS </strong></div>
        <hr>

        <a><button class="sidebar-button active"><i class="bi bi-layers-fill"></i>  OWNER DASHBOARD </button></a>

        <a href="{% url 'view_students' %}"><button class="sidebar-button"><i class="bi bi-person-vcard"></i>  View Students</button></a>
        
        <a href="{% url 'view_drivers' %}"><button class="sidebar-button"><i class="bi bi-person-vcard"></i>   View Drivers</button></a>
        
        <button class="sidebar-button" onclick="toggleDropdown('registrationDropdown', 'caret1')">
            <i class="bi bi-check2-circle"></i>  Approve Registrations <span class="badge badge-pill badge-success">{{ all_count }}</span>
            <i id="caret1" class="fas fa-caret-right"></i>
        </button>
        <div id="registrationDropdown" class="dropdown-content">
            <a href="{% url 'approve_students' %}"><button class="sidebar-button"><i class="bi bi-mortarboard"></i>  New Students <span class="badge badge-pill badge-success">{{ student_count }}</span></button></a>
            <a href="{% url 'approve_drivers' %}"><button class="sidebar-button"><i class="bi bi-truck-front"></i> New Drivers <span class="badge badge-pill badge-success">{{ driver_count }}</span></button></a>
        </div>
        
        <button class="sidebar-button" onclick="toggleDropdown('RequestsDropdown', 'caret2')">
            <i class="bi bi-check2-square"></i> Approve Requests <span class="badge badge-pill badge-success">{{ all_req }}</span>
            <i id="caret2" class="fas fa-caret-right"></i>
        </button>
        <div id="RequestsDropdown" class="dropdown-content">
            <a href="{% url 'all_complaints' %}"><button class="sidebar-button"><i class="bi bi-clipboard-check"></i>   Students Complaint    <span class="badge badge-pill badge-success">{{ complaint_count }}</span></button></a>
            <a href="{% url 'Fee_inc_req' %}"><button class="sidebar-button"><i class="bi bi-clipboard-check"></i>   Driver Fee Inc <span class="badge badge-pill badge-success">{{ Fee_inc_req_count }}</span></button></a>
            <a href="{% url 'delay_req' %}"><button class="sidebar-button"><i class="bi bi-clipboard-check"></i>   Driver Delay Req <span class="badge badge-pill badge-success">{{ delay_req_count }}</span></button></a>
        </div>
                
        <a href="{% url 'generate_fee' %}"><button class="sidebar-button"><i class="bi bi-receipt-cutoff"></i> generate fee</button></a>
        <!-- Close button to close the navigation bar -->
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>

<div class="sidebar-image">
    <a style="color: black;">
        <hr>
        <div class="image-button" onclick="handleButtonClick()">
            <img src="{% static 'images/owner_portal.jpg' %}" alt="Circular Image"><span>
            <div><strong>Osama Khursheed   </strong><i class="bi bi-box-arrow-left" style="font-size: 20px;" onclick="logoutOwnerPortal()"></i></div>
        </div>
    </a>
</div>
<script>
    function openNav() {
        document.getElementById("mySidebar").style.left = "0";
        document.getElementById("overlay").style.width = "100%";
        document.getElementById("overlay").style.opacity = "1";
    }

    function closeNav() {
        document.getElementById("mySidebar").style.left = "-250px";
        document.getElementById("overlay").style.width = "0";
        document.getElementById("overlay").style.opacity = "0";
    }
    function toggleDropdown(id, caretId) {
        var dropdown = document.getElementById(id);
        var caret = document.getElementById(caretId);
    
        if (dropdown.style.display === 'block') {
            dropdown.style.display = 'none';
            caret.classList.remove('rotate-down');
        } else {
            dropdown.style.display = 'block';
            caret.classList.add('rotate-down');
        }
    }
    window.onclick = function (event) {
        if (!event.target.matches('.sidebar-button')) {
            var dropdowns = document.getElementsByClassName('dropdown-content');
            for (var i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.style.display === 'block') {
                    openDropdown.style.display = 'none';
                    var caretId = openDropdown.id.replace("Dropdown", "caret");
                    document.getElementById(caretId).classList.remove('active');
                }
            }
        }
    }
    function logoutOwnerPortal() {
        window.location.href = "{% url 'logout' %}";
    }
</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.3/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>